<!-- Header and Details -->

<div class="flex-col flex items-center bg-white lg:bg-inherit">
  <div
    class="min-h-fit px-4 lg:px-2 pb-4 lg:pb-20 pt-5 bg-white lg:bg-[#EBEBEB] w-full rounded-b-[75px] lg:rounded-b-[110px]"
  >
    <div
      class="flex items-start justify-center lg:justify-around xl:justify-between"
    >
      <div
        class="flex flex-col lg:flex-row items-stretch justify-center mt-10 mx-2 lg:mx-10 h-full gap-5"
      >
        <div
          class="img-container min-h-[177px] md:min-h-0 aspect-square md:aspect-video"
        >
          <img
            *ngIf="dataLoaded.value"
            class="md:rounded-lg rounded-md"
            [src]="
              apiData.cardImagePath ? contentUrl + apiData.cardImagePath : ''
            "
            [alt]="apiData.secondTitle ? apiData.secondTitle : 'عکس بروکر'"
            width="245"
            height="137"
          />
          <div
            *ngIf="!dataLoaded.value"
            class="md:rounded-lg w-[249px] rounded-md h-full bg-slate-400 animate-pulse"
          ></div>
        </div>
        <div
          class="mt-[0.15rem] flex-col sm:flex items-start flex-wrap content-start hidden"
        >
          <b *ngIf="dataLoaded.value" class="text-[#098B41] font-black text-3xl"
            >بروکر {{ apiData.secondTitle.split("|")[0] }}</b
          >
          <b
            *ngIf="!dataLoaded.value"
            class="text-[#098B41] font-black text-3xl"
            >بروکر &nbsp;</b
          >
          <div class="flex items-center gap-1 mt-3">
            <span class="inline-block">
              <i class="flag-icon w-6"></i>
            </span>
            <p class="inline-block text-sm">
              دفتر مرکزی {{ apiData.countryName || "" }}
            </p>
          </div>
          <div
            class="inline-flex min-w-max px-2 py-0 border border-[#707070] items-center rounded-full mt-2"
          >
            <i class="ie-verified"></i>
            <p class="text-[#646464] text-xs pt-1 font-medium">
              {{ platforms }}
            </p>
          </div>
          <div class="flex-grow mt-5">
            <a
              *ngIf="dataLoaded.value"
              [href]="
                'https://' +
                apiData.webSiteLink.slice(10, apiData.webSiteLink.length)
              "
              target="_blank"
            >
              <button
                class="h-full min-w-[220px] w-max bg-[#098B41] rounded-lg text-white font-bold min-h-[42.95px]"
              >
                ورود به سایت اصلی بروکر
                <i class="ie-go-to-page scale-75 mr-1 align-middle"></i>
              </button>
            </a>
            <button
              *ngIf="!dataLoaded.value"
              class="h-full min-w-[220px] w-max bg-[#098B41] rounded-lg text-white font-bold min-h-[42.95px]"
            >
              ورود به سایت اصلی بروکر
              <i class="ie-go-to-page scale-75 mr-1 align-middle"></i>
            </button>
          </div>
        </div>
      </div>
      <div
        class="flex flex-col md:flex-row items-stretch gap-1 lg:gap-5 mt-10 mx-1 md:mx-5"
      >
        <div
          class="border bg-[#F3F3F3] border-gray-400 rounded-[9px] w-full max-w-[150px] min-w-[110px]"
        >
          <div
            class="flex flex-col items-center justify-center h-full px-2 gap-6"
          >
            <p class="text-[#646464] font-medium text-xs mt-3">
              امتیاز کاربران
            </p>
            <p class="text-[#646464] font-black text-rate">
              <i class="ie-star"></i>
              {{ apiData.staticRate / 2 | number : "1.1-2" || "   " }}
            </p>
          </div>
        </div>
        <div
          class="border bg-[#F3F3F3] border-gray-400 rounded-[9px] w-full max-w-[150px] min-w-[110px]"
        >
          <div
            class="flex flex-col items-center justify-center h-full px-2 gap-6"
          >
            <p class="text-[#646464] font-medium text-xs mt-3">
              امتیاز ایرانی اکسپرت
            </p>
            <p
              *ngIf="dataLoaded.value"
              class="text-[#646464] font-black text-rate"
            >
              {{ apiData.staticRate }}
            </p>
            <p
              *ngIf="!dataLoaded.value"
              class="text-[#646464] font-black text-rate"
            >
              &nbsp;
            </p>
          </div>
        </div>
      </div>
    </div>
    <div class="sm:hidden flex flex-col my-5">
      <div class="flex flex-row mx-2 gap-2 justify-center">
        <a
          class="basis-full"
          *ngIf="dataLoaded.value"
          [href]="
            'https://' +
            apiData.webSiteLink.slice(10, apiData.webSiteLink.length)
          "
          target="_blank"
        >
          <button
            class="w-full bg-[#098B41] rounded-lg text-white font-medium min-h-[50px] max-w-410px"
          >
            سایت اصلی بروکر
            <i class="ie-go-to-page scale-75 mr-1 align-middle"></i>
          </button>
        </a>
        <!-- <button class="basis-1/2">

        </button> -->
      </div>
      <p class="text-center mt-7 mb-4 text-3xl">
        <b class="text-[#098B41] font-black" *ngIf="dataLoaded.value">
          بروکر {{ apiData.secondTitle.split("|")[0] }}</b
        >
        <b class="text-[#098B41] font-black" *ngIf="!dataLoaded.value">
          بروکر {{ " " }}</b
        >
        <br />
        <b *ngIf="dataLoaded.value" class="text-[#098B41] font-black">{{
          apiData.secondTitle.split("|")[1] | uppercase
        }}</b>
        <b *ngIf="!dataLoaded.value" class="text-[#098B41] font-black">{{
          " "
        }}</b>
      </p>
      <div class="flex justify-center items-center gap-1 my-3">
        <span class="inline-block">
          <i class="flag-icon w-6"></i>
        </span>
        <p class="inline-block text-[#646464] font-medium">
          دفتر مرکزی {{ apiData.countryName }}
        </p>
      </div>
      <div
        class="inline-flex min-w-max px-2 py-0 border border-[#707070] items-center rounded-full mt-2 self-center"
      >
        <i class="ie-verified"></i>
        <p class="text-[#646464] pt-1 font-medium">{{ platforms }}</p>
      </div>
    </div>
  </div>
</div>

<!-- Header and Details -->

<!-- Detail List -->
<div
  class="flex flex-col-reverse items-stretch lg:items-start lg:flex-row mx-8 my-5 justify-center gap-8 lg:gap-12 px-3"
>
  <!-- Video & UL -->
  <div
    class="detail-container lg:relative mt-5"
    [ngClass]="
      dataLoaded.value && apiData.videoLink.startsWith('https://')
        ? 'lg:mt-64'
        : 'lg:mt-8'
    "
  >
    <ng-container *ngIf="dataLoaded.value">
      <div
        *ngIf="apiData.videoLink.startsWith('https://')"
        class="hidden lg:block absolute custom-position"
      >
        <div
          class="relative w-[535px] p-2 bg-white border border-[#707070] rounded-xl hover:opacity-100 opacity-80 transition-all lg:min-h-[256px]"
        >
          <app-video-player
            class="aspect-[16/10] rounded-xl"
            [VideoId]="1"
            [homeScreen]="false"
            [Link]="apiData.videoLink"
          ></app-video-player>
          <!-- <ng-container *ngIf="!dataLoaded.value">
            <div
              class="aspect-[16/10] bg-slate-400 object-cover rounded-xl animate-pulse"
            ></div> -->
          <!-- <img
            class="aspect-[16/10] object-cover rounded-xl"
            src="../../../../../assets/img/"
            alt="background-video"
          /> -->
          <!-- </ng-container> -->
          <!-- <button
            class="absolute translate-x-[50%] translate-y-[-50%] top-[50%] right-[50%] flex items-center justify-center w-20 h-20 rounded-full bg-[#3246D3]"
          >
            <i class="ie-icon ie-Polygon translate-x-[7px] translate-y-[3px]"></i>
          </button> -->
        </div>
      </div>
    </ng-container>
    <div
      *ngIf="dataLoaded.value && apiData.videoLink.startsWith('https://')"
      class="block self-center max-w-[487px] justify-center lg:hidden basis-full"
    >
      <!-- <div
        class="relative w-full p-2 bg-white border border-[#707070] rounded-xl hover:opacity-100 opacity-80 hover:border-[#3246D3] transition-all"
      > -->
      <app-video-player
        class="aspect-[16/10] rounded-xl"
        [VideoId]="2"
        [homeScreen]="false"
        [Link]="apiData.videoLink"
      ></app-video-player>
      <!-- <button
          class="absolute translate-x-[50%] translate-y-[-50%] top-[50%] right-[50%] flex items-center justify-center w-20 h-20 rounded-full bg-[#3246D3]"
        >
          <i class="ie-icon ie-Polygon translate-x-[7px] translate-y-[3px]"></i>
        </button> -->
      <!-- </div> -->
    </div>
    <app-single-broker-ul
      class="w-full"
      [hasVideo]="dataLoaded.value && apiData.videoLink.startsWith('https://')"
      [data]="brokerData"
      [load]="dataLoaded.value"
    />

    <!-- Alert Component -->
    <div
      class="bg-[#FFD5D5] flex flex-row items-center min-h-[4.5rem] rounded-2xl border border-[#CC3A39]"
    >
      <triangle class="inline-block" [scale]="'0.7'" />

      <div class="relative">
        <div class="flex flex-col py-2">
          <b class="text-[#CC3A39] text-sm font-black">هشدار&nbsp;!</b>
          <p class="text-[#CC3A39] text-sm font-medium word-spacing-0 pl-2">
            همه بروکرها اشکالاتی دارند. مسئولیت انتخاب بروکر و سود و ضرر افراد
            به عهده خود آنان است و «ایرانی اکسپرت» در این‌باره مسئولیتی ندارد
          </p>
        </div>
        <span class="colse-btn">&times;</span>
      </div>
    </div>

    <!-- Alert Component -->
  </div>
  <!-- Video & UL -->
  <div
    class="mt-8 basis-[55%] px-0 lg:px-4 lg:ml-2 max-w-[487px] lg:max-w-none flex flex-col lg:items-start self-center lg:self-start gap-2"
  >
    <span
      *ngIf="dataLoaded.value && apiData.videoLink.startsWith('https://')"
      class="inline-flex px-3 py-3 rounded-e-3xl rounded-tr-3xl bg-[#3246D3] bx-shadow-custom order-5 lg:order-1 mb-4"
      ><span class="chevron-container"
        ><i class="ie-icon ie-chevron right"></i
      ></span>
      <p class="text-lg text-white font-bold">
        ویدیو معرفی و بررسی {{ apiData.secondTitle }}
      </p></span
    >
    <p *ngIf="dataLoaded.value" class="mb-4 text-justify order-1 lg:order-2">
      {{ apiData.brief }}
    </p>
    <ng-container *ngIf="!dataLoaded.value">
      <span
        *ngFor="let holder of [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]"
        class="h-2 w-full block animate-pulse bg-slate-400 my-1 rounded-lg order-1 lg:order-2"
        >&nbsp;
      </span></ng-container
    >

    <!-- Ads Or Specials Place -->
    <div id="specials" class="my-5 order-3"></div>
    <!-- Ads Or Specials Place -->

    <div
      *ngIf="dataLoaded.value"
      class="relative order-2 lg:order-4 flex w-full sm:min-h-[222.19px] h-fit rounded-lg"
      (mouseenter)="hoveredOnImg = true"
      (mouseleave)="hoveredOnImg = false"
    >
      <img
        class="w-full aspect-video rounded-lg"
        [src]="contentUrl + apiData.secondCardImagePath"
        [alt]="'way'"
      />
      <div
        class="img-bg-hover"
        [ngClass]="hoveredOnImg ? 'active' : 'de-active'"
      >
        <a
          target="_blank"
          class="w-full h-full absolute"
          [href]="
            'https://' +
            apiData.webSiteLink.slice(10, apiData.webSiteLink.length)
          "
        ></a>
      </div>
    </div>
    <div
      *ngIf="!dataLoaded.value"
      class="relative order-2 lg:order-4 flex w-full h-full aspect-video bg-slate-400 animate-pulse rounded-lg"
    ></div>
    <div
      *ngIf="dataLoaded.value"
      class="w-full bg-white border-2 border-[#EEEEEE] order-4 lg:order-5 mt-5 px-5 py-4 rounded-2xl"
    >
      <p>
        <b class="text-[#098B41] text-xl font-bold mb-3"
          >بخشی از بررسی مختصر بروکر {{ apiData.secondTitle.split("|")[0] }}</b
        >
        <br />
        <br />
        {{ apiData.brief }}
      </p>
    </div>
  </div>
</div>

<!-- Detail List -->

<!-- Description -->

<div
  class="h-24 mx-8 flex py-2 justify-center bg-[#84AE40] items-center rounded-2xl"
>
  <img
    *ngIf="dataLoaded.value"
    id="transparent-img-{{ apiData.id }}"
    class="max-h-full object-contain self-center"
    [src]="contentUrl + apiData.cardImagePath"
    [alt]="apiData.title !== '' ? apiData.title : 'بنر'"
  />
  <div
    *ngIf="!dataLoaded.value"
    class="max-h-full object-contain self-center"
  ></div>
</div>

<!-- Description -->

<div id="description" class="flex flex-col lg:flex-row mx-4 my-5">
  <div class="basis-full hidden lg:block max-w-[370px] min-w-[270px]">
    <app-blog-filter [type]="'tags'" [categoryTags]="apiData.sharpLinkTags">
      <p header>دسترسی سریع</p>
    </app-blog-filter>
  </div>
  <div class="basis-full lg:basis3/4 flex flex-col mx-4">
    <div class="flex justify-between my-4">
      <div class="flex items-center w-44">
        <i class="ie-icon ie-broker-group scale-90"></i>
        <p class="text-[#098B41] font-bold text-lg mr-3">بررسی بروکر</p>
      </div>
      <button disabled class="flex items-center box-share disabled:opacity-25">
        <p class="icon-title ml-3">اشتراک گذاری</p>
        <i class="shared-icon"></i>
      </button>
    </div>
    <h1 class="font-black text-3xl">{{ apiData.title }}</h1>
    <div class="flex mt-3">
      <p class="text-black ml-10">اننتشار :{{ apiData.createDate | date }}</p>
      <p class="text-black">زمان مطالعه {{ apiData.studyTime }}دقیقه</p>
    </div>
    <div class="flex relative mt-4">
      <img
        class="img-blog"
        [src]="contentUrl + apiData.cardImagePath"
        alt="{{ apiData.title }}"
        width="100"
        height="100"
      />
      <div class="absolute flex h-full w-full items-center">
        <div class="sm:mt-40 sm:mr-12">
          <div class="divider" [style]="'background-color:' + '#fff'"></div>
          <p class="font-extrabold text-3xl text-white">{{ apiData.title }}</p>
        </div>
      </div>
    </div>
    <div [innerHTML]="brokerDescHtml"></div>
    <div
      *ngIf="dataLoaded.value"
      class="flex flex-col md:flex-row justify-center items-stretch gap-10"
    >
      <div class="inline-flex flex-col space-y-3 basis-1/2">
        <p class="text-center text-[#098B41] font-medium text-xl">مزایا</p>
        <div
          class="bg-white border-2 border-[#EEEEEE] mt-3 px-5 py-4 rounded-2xl flex-col flex space-y-5 h-full"
        >
          <div
            class="flex flex-row items-center gap-3"
            *ngFor="let advantage of apiData.advantages.split('@')"
          >
            <div class="circle-tick">
              <i class="icon-tick"></i>
            </div>
            <p>
              {{ advantage }}
            </p>
          </div>
        </div>
      </div>
      <div class="inline-flex flex-col space-y-3 basis-1/2">
        <p class="text-center text-[#CC3A39] font-medium text-xl">معایب</p>
        <div
          class="bg-white border-2 border-[#EEEEEE] mt-3 px-5 py-4 rounded-2xl flex-col flex space-y-5 h-full"
        >
          <div
            class="flex flex-row items-center gap-3"
            *ngFor="let disAdvantages of apiData.disAdvantages.split('@')"
          >
            <div class="circle-tick !bg-[#CC3A39]">
              <i class="ie-icon ie-times translate-y-[3px]"></i>
            </div>
            <p>
              {{ disAdvantages }}
            </p>
          </div>
        </div>
      </div>
    </div>
    <div class="flex items-center my-10">
      <img src="../../../assets/img/avatar-c.webp" alt="avatar" width="50" />
      <div class="flex items-center max-md:flex-col">
        <span class="font-bold text-2xl mx-3">{{ apiData.author }}</span>
        <small>تعداد بازدید کل : {{ " 135" }} </small>
      </div>
    </div>
    <div class="my-10 opacity-30 select-none relative">
      <!-- <app-vote /> -->
      <app-comments />
      <div
        class="absolute w-full h-full z-10 bg-transparent translate-x-[50%] translate-y-[-50%] top-[50%] right-[50%]"
      ></div>
    </div>
  </div>
  <!-- Benefits -->

  <!-- Benefits -->
  <!-- <div class="inline-block border border-gray-400 rounded-[9px] min-w-[26px]">
  <p class="mx-4 my-2 text-sm font-medium">
    جدیدترین خبر های بروکر را به من اطلاع بده
  </p>
</div> -->
</div>
